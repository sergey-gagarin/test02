<? include("header.php");     function schrijfshows($shows)     {        $fp = fopen("shows", "w");        for($i = 0; $i < sizeof($shows); $i++) {            fputs($fp, date('d/m/Y', $shows[$i][0])."\n");            fputs($fp, $shows[$i][1]."\n");            fputs($fp, $shows[$i][2]."\n");            fputs($fp, $shows[$i][3]."\n");            fputs($fp, $shows[$i][4]."\n");        }        fclose($fp);    }    /* Shows in geheugen. */    $n = 0;    $shows = array();    /* Lees de entries uit de file. */    $fp = fopen("shows", "r");    while (!feof($fp)) {        $datum = fgets($fp, 1024);        $plaats = fgets($fp, 1024);        $stad = fgets($fp, 1024);        $tijd = fgets($fp, 1024);        $specs = fgets($fp, 1024);        if ($datum && $plaats && $stad && $tijd && $specs) {            $shows[$n] = array();               		    $t = split("/", $datum);   	    	$datum = mktime(0, 0, 0, $t[1], $t[0], $t[2]);            $shows[$n][0] = chop_newline($datum);            $shows[$n][1] = chop_newline($plaats);            $shows[$n][2] = chop_newline($stad);            $shows[$n][3] = chop_newline($tijd);            $shows[$n][4] = chop_newline($specs);            $n++;        }    }    fclose($fp);        $actie = $HTTP_POST_VARS["actie"];    $datum = stripcslashes($HTTP_POST_VARS["datum"]);    $plaats = stripcslashes($HTTP_POST_VARS["plaats"]);    $stad = stripcslashes($HTTP_POST_VARS["stad"]);    $tijd = stripcslashes($HTTP_POST_VARS["tijd"]);    $specs = stripcslashes($HTTP_POST_VARS["specs"]);    $olddatum = stripcslashes($HTTP_POST_VARS["olddatum"]);    $oldplaats = stripcslashes($HTTP_POST_VARS["oldplaats"]);    $oldstad = stripcslashes($HTTP_POST_VARS["oldstad"]);    $oldtijd = stripcslashes($HTTP_POST_VARS["oldtijd"]);    $oldspecs = stripcslashes($HTTP_POST_VARS["oldspecs"]);    /* Het toevoegen en verwijderen van items. */    if ($actie == "toevoegen" || $actie == "verwijderen" || $actie == "wijzigen") {        if (!($datum && $plaats && $stad && $tijd && $specs))            $actie = "";        else {   		    $t = split("/", $datum);   	    	$datum = mktime(0, 0, 0, $t[1], $t[0], $t[2]);               		    $t = split("/", $olddatum);   	    	$olddatum = mktime(0, 0, 0, $t[1], $t[0], $t[2]);                        if ($actie == "toevoegen") {                $i = sizeof($shows);                $shows[$i][0] = "$datum";                $shows[$i][1] = "$plaats";                $shows[$i][2] = "$stad";                $shows[$i][3] = "$tijd";                $shows[$i][4] = "$specs";                schrijfshows($shows);            }            elseif ($actie == "wijzigen") {                for ($i = 0; $i < sizeof($shows); $i++)                    if ($shows[$i][0] == $olddatum && $shows[$i][1] == $oldplaats && $shows[$i][2] == $oldstad && $shows[$i][3] == $oldtijd && $shows[$i][4] == $oldspecs)                        break;                if ($i == sizeof($shows))                    $key = false;                else                    $key = $i;                                if (!($key === false)) {                    $shows[$key][0] = "$datum";                    $shows[$key][1] = "$plaats";                    $shows[$key][2] = "$stad";                    $shows[$key][3] = "$tijd";                    $shows[$key][4] = "$specs";                    schrijfshows($shows);                }            }            elseif ($actie == "verwijderen") {                for ($i = 0; $i < sizeof($shows); $i++)                    if ($shows[$i][0] == $datum && $shows[$i][1] == $plaats && $shows[$i][2] == $stad && $shows[$i][3] == $tijd && $shows[$i][4] == $specs)                        break;                if ($i == sizeof($shows))                    $key = false;                else                    $key = $i;                                if (!($key === false)) {                    $shows[$key] = $shows[sizeof($shows) - 1];                    $shows = array_slice($shows, 0, sizeof($shows) - 1);                    schrijfshows($shows);                }            }        }    }    array_multisort($shows);?><script language="javascript">    function showslink(n)    {        switch (n) {        <? for ($i = 0; $i < sizeof($shows); $i++) { ?>            case <? echo $i ?>:                document.frmshow.datum.value = '<? echo date('d/m/Y', $shows[$i][0]) ?>';                document.frmshow.plaats.value = '<? echo addjsslashes($shows[$i][1]) ?>';                document.frmshow.stad.value = '<? echo addjsslashes($shows[$i][2]) ?>';                document.frmshow.tijd.value = '<? echo addjsslashes($shows[$i][3]) ?>';                document.frmshow.specs.value = '<? echo addjsslashes($shows[$i][4]) ?>';                document.frmshow.olddatum.value = '<? echo date('d/m/Y', $shows[$i][0]) ?>';                document.frmshow.oldplaats.value = '<? echo addjsslashes($shows[$i][1]) ?>';                document.frmshow.oldstad.value = '<? echo addjsslashes($shows[$i][2]) ?>';                document.frmshow.oldtijd.value = '<? echo addjsslashes($shows[$i][3]) ?>';                document.frmshow.oldspecs.value = '<? echo addjsslashes($shows[$i][4]) ?>';                break;        <? } ?>        }    }        function wissen()    {        document.frmshow.datum.value = '';        document.frmshow.plaats.value = '';        document.frmshow.stad.value = '';         document.frmshow.tijd.value = '';         document.frmshow.specs.value = '';     }    function toevoegen()    {        document.frmshow.actie.value = "toevoegen";        document.frmshow.submit();    }        function wijzigen()    {        document.frmshow.actie.value = "wijzigen";        document.frmshow.submit();    }    function verwijderen()    {        document.frmshow.actie.value = "verwijderen";        document.frmshow.submit();    }</script><br>  <table width="500" cellspacing="2" cellpadding="2" border="0"><?	for ($j = sizeof($shows) - 1; $j >= 0; $j--) { ?>        <tr>         <?          if ($shows[$j][0] > time())             $color = "bgcolor=\"#eeeeee\"";         else            $color = "";         echo "<td ".$color.">";         echo "<a href=\"javascript:showslink($j)\">".$dagnamen[date('D', $shows[$j][0])]." ".date('d/m/Y', $shows[$j][0])."</a>";          echo "</td>";         echo "<td ".$color.">";         echo $shows[$j][2];         echo "</td>";         echo "<td ".$color.">";         echo $shows[$j][4];         echo "</td>";         ?>        </tr><?  } ?></table><br>    <table width="360" cellspacing="2" cellpadding="2" border="0">  <tr><td>  <form name="frmshow" action="shows.php" method="post">   Date:<br>   <input type="text" name="datum" maxlength="10" class="formText" value="<? echo date('d/m/Y') ?>"></td><td>   Place:<br>   <input type="text" name="stad" maxlength="20" class="formText"></td></tr><tr><td>   Specs:<br>   <input type="text" name="specs" maxlength="80" class="formText">   <input type="hidden" name="plaats" value="bla">   <input type="hidden" name="tijd" value="bla">   <input type="hidden" name="olddatum">   <input type="hidden" name="oldplaats">   <input type="hidden" name="oldstad">   <input type="hidden" name="oldtijd">   <input type="hidden" name="oldspecs">   <input type="hidden" name="actie" value="toevoegen">  </td><td><br><a href="javascript:wissen()">Clear</a> | <a href="javascript:toevoegen()">Add</a> | <a href="javascript:wijzigen()">Change</a> | <a href="javascript:verwijderen()">Delete</a> </td></tr></table></form></td></tr></table></body></html>